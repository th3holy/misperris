!function(a){function b(a,b){a.closest(".rut-container").append(b)}a.fn.rut=function(c){var d=a.extend({error_html:'<span class="rut-error">Rut incorrecto</span>',formatear:!0,on:"blur",required:!0,placeholder:!0,fn_error:function(a){b(a,d.error_html)},fn_validado:function(a){}},c);return this.each(function(){var b=a(this);b.wrap('<div class="rut-container"></div>'),b.attr("pattern","[0-9]{1,2}.[0-9]{3}.[0-9]{3}-[0-9Kk]{1}").attr("maxlength",12),d.required&&b.attr("required","required"),d.placeholder&&b.attr("placeholder","12.345.678-5"),d.formatear&&b.on("blur",function(){b.val(a.rut.formatear(b.val()))}),b.on(d.on,function(){a(".rut-error").remove(),a.rut.validar(b.val())&&""!=a.trim(b.val())?d.fn_validado():d.fn_error(b)})})}}(jQuery),jQuery.rut={validar:function(a){if(!/[0-9]{1,2}.[0-9]{3}.[0-9]{3}-[0-9Kk]{1}/.test(a))return!1;var b=a.split("-"),c=b[1],a=b[0].split(".").join("");return"K"==c&&(c="k"),$.rut.dv(a)==c},dv:function(a){for(var b=0,c=1;a;a=Math.floor(a/10))c=(c+a%10*(9-b++%6))%11;return c?c-1:"k"},formatear:function(a){for(var b=this.quitar_formato(a),a=b.substring(0,b.length-1),c="";a.length>3;)c="."+a.substr(a.length-3)+c,a=a.substring(0,a.length-3);return""==$.trim(a)?"":a+c+"-"+b.charAt(b.length-1)},quitar_formato:function(a){return a=a.split("-").join("").split(".").join("")}};
